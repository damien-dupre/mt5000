---
title: "Tutorial 2: MS EXCEL"
subtitle: "MT5000 - Data Analytics & Visualization"
author: "Damien Dupr√©"
date: "Dublin City University"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: solarized-light
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include = FALSE}
# general options --------------------------------------------------------------
options(scipen = 999)
set.seed(42)
# chunk options ----------------------------------------------------------------
knitr::opts_chunk$set(
  cache.extra = knitr::rand_seed, 
  message = FALSE, 
  warning = FALSE, 
  error = FALSE, 
  echo = FALSE,
  cache = FALSE,
  eval = TRUE,
  comment = "", 
  fig.align = "center", 
  fig.retina = 3
  )
# libraries --------------------------------------------------------------------
library(tidyverse)
library(knitr)
library(fontawesome)

# theme ------------------------------------------------------------------------
library(xaringanthemer)
style_mono_light(
  base_color = "#23395b",
  code_inline_background_color ="#23395b"
  )
```

# Objectives

This tutorial is about how to clean a .xlxs document with MS EXCEL to make its format suitable for further analyses.

```{r out.width='80%'}
include_graphics("https://www.bizprospex.com/wp-content/uploads/2016/09/Clean-Data.jpg")
```

---
class: inverse, mline, center, middle

# 1. Data Cleaning

---

# The Dataset

From the Module Loop page:

- Go to the Data tile
- Download the file "unicef.xls" on your desktop

---

# Cleaning Operations

## 1. Ditch the chart and all non values

## 2. Save as .csv file

## 3. Column headings in row 1

## 4. Columns start at column A

---
class: inverse, mline, center, middle

# 2. Data Transformation

---

# The Dataset

From the Module Loop page:

- Go to the Data tile
- Download the files "products.csv" and "suppliers.csv" on your desktop

---

# Transformation Operations

## 1. Extension

1.1. In the suppliers table, create a new variable called "company_name" and use the symbol = to copy the value of the variable "companyName" 

1.2. In the suppliers table, create the new variable "full_address" by using the function CONCATENATE with the variables "address", "city" and "country"

1.3. In the products table, create the new variable "profit_max" by multiplying unitPrice with unitInStock

---

# Transformation Operations

## 2. Reduction

2.1. In the suppliers table, filter the variable country to keep only the suppliers based in Mexico

2.2. In the products table, filter the variable productID to keep only the productID which is 3

---

# Transformation Operations

## 3. Reduction

3.1. In the suppliers table, sort countries by descending alphabetical order

3.2. In the suppliers table, sort countries by descending alphabetical order and companyName by ascending alphabetical order

---

# Transformation Operations

## 4. Aggregation

4.1. In the suppliers table, use a pivot table to count how many companies by country is there

4.2. In the products table, use a pivot table to summarise the average price, maximum price and minimum price by prodcutID

---

# Transformation Operations

## 5. Combination

5.1. In the products table, use the VLOOKUP function to add the variable companyName from the table suppliers by using the productID key variable

---
class: inverse, mline, left, middle

<img class="circle" src="https://github.com/damien-dupre.png" width="250px"/>

# Thanks for your attention!